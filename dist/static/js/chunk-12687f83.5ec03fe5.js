(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-12687f83"],{"0326":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-container",[a("el-header",{staticClass:"header-text-line-height h1-font header-bottom-border"},[t._v("用户行为")]),t._v(" "),a("el-main",[a("el-row",[a("el-col",{attrs:{span:14}},[a("el-container",[a("el-main",{staticClass:"h2-font bold-weight-font"},[t._v("\n            选取时间段：\n          ")]),t._v(" "),a("el-footer",[a("el-time-select",{attrs:{placeholder:"起始时间","picker-options":t.optionsCommon},model:{value:t.startTime,callback:function(e){t.startTime=e},expression:"startTime"}}),t._v(" 到 \n            "),a("el-time-select",{attrs:{placeholder:"结束时间","picker-options":Object.assign({},t.optionsCommon,{minTime:t.startTime})},model:{value:t.endTime,callback:function(e){t.endTime=e},expression:"endTime"}})],1)],1)],1),t._v(" "),a("el-col",{attrs:{span:2}},[a("el-button",{staticClass:"btn-margin",attrs:{type:"primary",icon:"el-icon-search"},on:{click:t.searchInfo}},[t._v("查询")])],1)],1),t._v(" "),a("el-row",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"common-container top-radius"},[a("el-col",{attrs:{span:24}},[a("panel-top",{attrs:{title:"用户行为数据查询结果"}}),t._v(" "),t.isDataInit?a("el-row",{staticClass:"charts-margin"},[a("el-col",{attrs:{span:22,offset:1}},[a("Histogram",{attrs:{source:t.posSourceData,"x-axis-name":"timer","chart-id":"pos",legends:t.legends,graphics:"line",title:"10p数据展示"}})],1)],1):t._e(),t._v(" "),t.isDataInit?a("el-row",{staticClass:"charts-margin"},[a("el-col",{attrs:{span:22,offset:1}},[a("Histogram",{attrs:{source:t.todaySourceData,"x-axis-name":"timer","chart-id":"today",legends:t.legends,graphics:"line",title:"today数据展示"}})],1)],1):t._e()],1)],1)],1)],1)},i=[],r=(a("28a5"),a("7c1d")),o=a("5832"),s=a("c466"),c=a("17c2"),u=a("cc4c"),l={name:"BehaviorChart",components:{PanelTop:r["a"],Histogram:o["a"]},data:function(){return{startTime:"",endTime:"",optionsCommon:{start:"00:00",step:"00:10",end:""},legends:[],posSourceData:[],todaySourceData:[],isDataInit:!1,loading:!1}},created:function(){this._initEndTime(),this.searchInfo()},methods:{searchInfo:function(){var t=this;this.loading=!0;var e=Object(s["c"])(),a=e.year,n=e.month,i=e.day,r=this._formatTimeKey(this.endTime).hour,o=this._formatTimeKey(this.endTime).minute,l=this._formatTimeKey(this.startTime).hour||this._getDefaultStartTime(r,o).start_h,d=this._formatTimeKey(this.startTime).minute||this._getDefaultStartTime(r,o).start_m,h=new Date(+a,+n-1,+i,+l,+d),f=new Date(+a,+n-1,+i,+r,+o);Object(c["b"])({start_time:Date.parse(h)/1e3,end_time:Date.parse(f)/1e3}).then(function(e){var a=Object(u["b"])(e.data);t.legends=a.legends,t.posSourceData=a.posRes,t.todaySourceData=a.todayRes,t.isDataInit=!0,t.loading=!1}).catch(function(e){console.error(e),t.$notify({title:"未知错误",message:"请检查网络后刷新重试",type:"error"}),t.loading=!1})},_getDefaultStartTime:function(t,e){var a="",n="";return+e-20<0?(n=40,a=t-1<10?"".concat(t-1):t-1):(n=+e-20,a=t),console.log({start_h:a,start_m:n}),{start_h:a,start_m:n}},_initEndTime:function(){var t=Object(s["a"])();this.optionsCommon.end=t,this.endTime=this._formatEndTime(t)},_formatEndTime:function(t){var e=t.split("");return e[e.length-1]="0",e.join("")},_formatTimeKey:function(t){var e=t.split(":");return{hour:e[0],minute:e[1]}}}},d=l,h=(a("9920"),a("2877")),f=Object(h["a"])(d,n,i,!1,null,"3ef4f0b0",null);e["default"]=f.exports},"17c2":function(t,e,a){"use strict";a.d(e,"a",function(){return r}),a.d(e,"b",function(){return o});var n=a("f8c8"),i=a("a27e");function r(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"1",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"1",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"10";return Object(i["a"])({url:"".concat(n["a"],"/4/data/dspActStat"),method:"get",params:{source:n["b"],dt:t,material_pos:e,is_material:a,limit:r}})}function o(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"real_time@all";return t=JSON.stringify(t),Object(i["a"])({url:"".concat(n["a"],"/4/data/dspActStat"),method:"get",params:{source:n["b"],dt:t,material_pos:e}})}},5832:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{style:{width:t.width,height:t.height},attrs:{id:t.chartId}})},i=[],r=a("313e"),o=a.n(r),s=a("f42c"),c={name:"Histogram",mixins:[s["a"]],props:{width:{type:String,default:"100%"},height:{type:String,default:"300px"},source:{type:Array,default:null},xAxisName:{type:String,default:""},title:{type:String,default:"数据分布展示"},chartId:{type:String,default:"0"},tipName:{type:String,default:"次数"},legends:{type:Array,default:null},graphics:{type:String,default:"bar"}},data:function(){return{chart:null}},watch:{source:{handler:function(){this.initChart()},deep:!0}},mounted:function(){this.initChart()},beforeDestroy:function(){this.chart&&(this.chart.dispose(),this.chart=null)},methods:{_initSeries:function(){var t=[];if(this.source)for(var e=this.source[0].length-1,a=0;a<e;a++)t.push({name:this.legends[a],type:this.graphics,markLine:{data:[{type:"average",name:"平均值"}]}});return t},initChart:function(){if(0===this.source.length)return this.$message.error("存在空数据项"),!1;this.chart=o.a.init(document.getElementById(this.chartId)),this.chart.setOption({title:{text:"".concat(this.title),textStyle:{fontWeight:"bolder",fontSize:16,color:"#000000"}},legend:{data:this.legends},tooltip:{trigger:"axis"},toolbox:{show:!0,itemGap:20,feature:{dataView:{title:"数据视图"},magicType:{show:!0,type:["bar","line"]},saveAsImage:{show:!0},restore:{}}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",name:this.xAxisName},dataset:{source:this.source},series:this._initSeries(),yAxis:[{type:"value"}]},!0)}}},u=c,l=a("2877"),d=Object(l["a"])(u,n,i,!1,null,"6d35ccbc",null);e["a"]=d.exports},9920:function(t,e,a){"use strict";var n=a("da67"),i=a.n(n);i.a},a27e:function(t,e,a){"use strict";var n=a("bc3a"),i=a.n(n),r=i.a.create({baseURL:"",timeout:5e3});r.interceptors.request.use(),r.interceptors.response.use(),e["a"]=r},c466:function(t,e,a){"use strict";function n(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Date,i=n.getMonth()+1+e<10?"0".concat(n.getMonth()+1):n.getMonth()+1+e,r=n.getDate()+a<10?"0".concat(n.getDate()):n.getDate()+a;return"".concat(n.getFullYear()+t).concat(i).concat(r)}function i(){var t=new Date,e=t.getMinutes()<10?"00":t.getMinutes();return"".concat(t.getHours(),":").concat(e)}function r(t){var e=t?new Date(t):new Date;return{year:e.getFullYear(),month:e.getMonth()+1<10?"0".concat(e.getMonth()+1):e.getMonth()+1,day:e.getDate()<10?"0".concat(e.getDate()):e.getDate(),hour:e.getHours()<10?"0".concat(e.getHours()):e.getHours(),minute:e.getMinutes()<10?"0".concat(e.getMinutes()):e.getMinutes(),second:e.getSeconds()<10?"0".concat(e.getSeconds()):e.getSeconds()}}a.d(e,"b",function(){return n}),a.d(e,"a",function(){return i}),a.d(e,"c",function(){return r})},cc4c:function(t,e,a){"use strict";a.d(e,"a",function(){return s}),a.d(e,"c",function(){return c}),a.d(e,"d",function(){return u}),a.d(e,"b",function(){return l});a("28a5"),a("ac6a"),a("456d");var n={product:"send_prod",uv:"send_uv",pv:"send_pv"},i={product:"action_prod",uv:"action_uv",pv:"action_pv"},r=["action_statistic","send_statistic"],o=[i,n];function s(t){var e=[];if(0===Object.keys(t.data).length)return e;var a=[];return Object.keys(t.data).forEach(function(e){a.push({date_time:e,value:t.data[e]})}),a[0].value.material_pos.forEach(function(t){e.push({label:t+"",value:t+""})}),e}function c(t,e){var a=[];if(0===Object.keys(t.data).length)return a;var n=0;return Object.keys(t.data).forEach(function(i){a.push({date_time:i});for(var s=t.data[i],c=function(t){Object.keys(s[r[t]][e]).forEach(function(i){a[n][o[t][i]]=s[r[t]][e][i]})},u=0;u<r.length;u++)c(u);n++}),a}function u(t,e){var a=[];if(0===Object.keys(t.data).length)return a;var n=t.data;Object.keys(n).forEach(function(t){a.push({date_time:t})});for(var i=function(t){var i=n[a[t]["date_time"]]["material_statistic"][e];Object.keys(i).forEach(function(e){Object.keys(i[e]).forEach(function(n){a[t]["".concat(e,"_").concat(n)]=i[e][n]})})},r=0;r<a.length;r++)i(r);return a}function l(t){var e=[],a=[],n=[];if(t.errcode||0===Object.keys(t.data).length)return{posRes:a,todayRes:e,legends:n};var i=t.data,r=Object.keys(i)[0],o=i[r]["action_statistic"];return Object.keys(o).forEach(function(t){n.push(t)}),Object.keys(i).forEach(function(t,n){var r=d(t);e.push([r]),a.push([r]);var o=i[t]["action_statistic"];Object.keys(o).forEach(function(t){e[n].push(o[t]["today"]?o[t]["today"]:0),a[n].push(o[t]["10p"]?o[t]["10p"]:0)})}),{posRes:a,todayRes:e,legends:n}}function d(t){var e=t.split("");return"".concat(e[0]).concat(e[1],":").concat(e[2]).concat(e[3])}},da67:function(t,e,a){},f8c8:function(t,e,a){"use strict";a.d(e,"a",function(){return n}),a.d(e,"b",function(){return i});var n="",i="3567320871234567890"}}]);